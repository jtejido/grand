package source64_test

import (
	"github.com/jtejido/grand"
	"github.com/jtejido/grand/source64"
	"testing"
)

func TestLFSR258(t *testing.T) {
	rng, err := source64.NewLFSR258FromStream([]uint64{123456789123456789, 123456789123456789, 123456789123456789, 123456789123456789, 123456789123456789})

	if err != nil {
		t.Errorf("Error occured.")
	}

	r := grand.New(rng)

	expected := []uint64{
		9973624093427544505,
		17203455483290184537,
		3469538395387468010,
		8795315472740051422,
		6545042816095807101,
		921887431183000049,
		3948372345325325974,
		11347449174268212885,
		7669170156346524803,
		14853824763139638908,
		298087058898021150,
		10638218558931126049,
		13362399610150342187,
		14762022575333355170,
		14399936350193522515,
		4830261719731769614,
		13031354057068113846,
		11522855319181366418,
		15178098034118651547,
		13496575408278182207,
		8245354812123297616,
		7827910547406541858,
		11514522524250713699,
		8889209050929786449,
		13423142018782532141,
		3600127065702389220,
		10589888089919106003,
		4235233797362030790,
		15094526815281689911,
		880197778737883573,
		4165464693849484743,
		3397496171240478474,
		346723102095043441,
		12982490638711984205,
		12171253864103233552,
		7733361558549858262,
		9133078661241920425,
		3676618637163626399,
		1766039269793535888,
		7348512294098140301,
		3985774790720156646,
		4242866672896596200,
		15188419100682577264,
		13821663537906320449,
		1084818666193149364,
		326914726533805767,
		13724407595791335169,
		1626016045766137,
		7537850317485942116,
		2103176593979906927,
		4440394985717450652,
		5147627009691321172,
		1723861344201048314,
		11221680758261263369,
		7905265320974739336,
		18150061077990704091,
		9136275006271220329,
		12517756855329734977,
		17472397034436931267,
		18258415399923738852,
		15326428377151300812,
		8228752135443868423,
		6737340297623025952,
		13569759773260246661,
		15798474013506701877,
		12000191544349614049,
		12986792188293555153,
		2624405817456297447,
		6503030962139211445,
		15654252817238710275,
		2225999328360941326,
		2008223404290738521,
		1322981573924077519,
		15561793839237304991,
		14162706444275196884,
		11035571215479322342,
		2879884271951348735,
		1304638425809473748,
		5872670045125896198,
		7015880467978405713,
		3361539306260459325,
		785285336537290256,
		5701392953054781838,
		12108902400510582590,
		8260675384566491213,
		16740174919453777673,
		10884484551033332510,
		4654396191015013648,
		3990015345105442446,
		3555958582882183517,
		16020229030193333721,
		6722950687868410113,
		14684016632949997374,
		2494472922492633166,
		3634946883476211457,
		15332274928668013066,
		13915436771663673908,
		9935279685165054948,
		17382729679832344598,
		18223301165269514717,
	}

	for i := 0; i < len(expected); i++ {
		rg := r.Uint64()
		if expected[i] != rg {
			t.Errorf("Mismatch. want: %v, got: %v", expected[i], rg)
		}
	}
}
